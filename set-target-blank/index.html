<!DOCTYPE html>
<html>

  <head>
  <meta name="google-site-verification" content="nbQ3DH1tU2S227w0_LZKTOi0LhBBzGRYnN_ARxSDuYY" />
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>JavaScriptによるtarget="_blank"の指定 | Kaffee Kantate</title>
  <meta name="description" content="Markdown記法でtarget="_blank"を指定するのが面倒だったのでJavaScriptで外部サイトは別タブで開くように設定。">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://blog.kaffeekantate.xyz/set-target-blank/">
  <link rel="alternate" type="application/rss+xml" title="Kaffee Kantate" href="http://blog.kaffeekantate.xyz/feed.xml" />

  <meta property="og:title" content="JavaScriptによるtarget="_blank"の指定 | Kaffee Kantate" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="Markdown記法でtarget="_blank"を指定するのが面倒だったのでJavaScriptで外部サイトは別タブで開くように設定。" />
  <meta property="og:url" content="http://blog.kaffeekantate.xyz/set-target-blank/" />
  <meta property="og:image" content="http://blog.kaffeekantate.xyz/images/2015/" />
  <meta property="og:site_name" content="Kaffee Kantate" />
  <meta property="fb:app_id" content="1420984721525609" />

  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/manifest.json">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <hgroup class="site-title-group">
    <h1 class="site-title"><a class="site-title" href="/">Kaffee Kantate</a></h1>
    <h3 class="site-subtitle">Life in Vancouver, Tech, Coffee, etc</h3>
    </hgroup>


    <nav class="site-nav">

      <div class="trigger">
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">JavaScriptによるtarget="_blank"の指定</h1>
    <p class="post-meta">Jan 18, 2015</p>
    <div class="post-tag"><a href="/tag/javascript" rel="tag">javascript</a>, <a href="/tag/jekyll" rel="tag">jekyll</a></div>
  </header>

  <article class="post-content">
    <p>Markdownで記事本文に外部リンクをはった際に自動でtarget=”_blank”が設定されるように以下のコードを追加。</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
	<span class="kd">var</span> <span class="nx">links</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">links</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">links</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">hostname</span> <span class="o">!=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hostname</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">links</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">target</span> <span class="o">=</span> <span class="s1">&#39;_blank&#39;</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}());</span></code></pre></div>

<p>linksプロパティで文書中のarea/anchor要素をHTMLCollectionとして取得し、現在のURLのホスト名と取得した要素のホスト名が異なっていればtarget = “_blank”を指定。</p>

<p>ちなみに文書中から全て取得する必要はないので記事のみを対象に
<code>
Document.getElementsByClassName('post-content').links
</code>
とかやってみたものの、linksはdocumentオブジェクトに属するため無理でした
(参考: <a href="https://developer.mozilla.org/ja/docs/Web/API/document">documentオブジェクト</a>)。</p>

<p>基本的に外部サイトは別タブで開くようにしているので自分の場合はこれで問題ないですが、どうしても個別に指定したい場合はplugin探すか素直にhtml書いたほうがいいですね。</p>

<h4 id="section">追記</h4>
<p>Markdownのパーサーにkramdownを使っていれば</p>

<p><code>
[link](url){: attribute="value"}
</code></p>

<p>が使えるので<code>{:target="_blank"}</code>をつけてあげれば対応可能と知りました。</p>


    <div class="social">
	<div class="fb-like social-button" data-href="https://developers.facebook.com/docs/plugins/" data-layout="button" data-action="like" data-show-faces="true" data-share="false" height="20"></div>

	<a href="https://twitter.com/share" class="twitter-share-button social-button" data-count="none">Tweet</a>

	<a href="http://b.hatena.ne.jp/entry/http://blog.kaffeekantate.xyz/set-target-blank/" class="hatena-bookmark-button social-button" data-hatena-bookmark-layout="standard-noballoon" data-hatena-bookmark-lang="en" title="このエントリーをはてなブックマークに追加" target="_blank"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a>

</div>


  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">

      <div class="footer-col  footer-col-1">
        <h3>Tags</h3>
        <div class="footer-tags"><a href="/tag/art" class="set-1">art</a> <a href="/tag/bcit" class="set-5">bcit</a> <a href="/tag/cafe" class="set-1">cafe</a> <a href="/tag/css" class="set-5">css</a> <a href="/tag/english-article" class="set-1">english-article</a> <a href="/tag/github" class="set-1">github</a> <a href="/tag/javascript" class="set-5">javascript</a> <a href="/tag/jekyll" class="set-5">jekyll</a> <a href="/tag/museum" class="set-1">museum</a> <a href="/tag/music" class="set-1">music</a> <a href="/tag/vancouver" class="set-5">vancouver</a> <a href="/tag/%E5%BE%92%E7%84%B6" class="set-1">徒然</a> <a href="/tag/%E7%95%99%E5%AD%A6" class="set-5">留学</a></div>

      </div>


      <div class="footer-col  footer-col-2">
        <h3>Author</h3>
        <p class="text footer-info">Kay: System engineer in Tokyo -> Student at BCIT -> Web developer in Vancouver. Also writing a English blog in <a href="https://medium.com/@kay_ya">Medium</a></p>
        <ul class="contact-list">
          <li><a href="/feed.xml"><i class="fa fa-rss-square"></i></a></li>
          <li><a href="https://github.com/kay8" target="_blank"><i class="fa fa-github-square"></i></a></li>
          <li><a href="mailto:kay.yamagishi.work@gmail.com"><i class="fa fa-envelope-square"></i></a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text copyright">&copy; 2015 <a href="/">Kaffee Kantate</a>, Powered by <a href="http://jekyllrb.com/">Jekyll</a></p>
      </div>
    </div>

  </div>

</footer>


  </body>
      <script>
  	// Async Sharing Buttons
	(function(doc, script) {
	  var js,
	      fjs = doc.getElementsByTagName(script)[0],
	      frag = doc.createDocumentFragment(),
	      add = function(url, id) {
	          if (doc.getElementById(id)) {return;}
	          js = doc.createElement(script);
	          js.src = url;
	          id && (js.id = id);
	          frag.appendChild( js );
	      };

	    // Facebook SDK
	    add('//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=1420984721525609&version=v2.2', 'facebook-jssdk');
	    // Twitter SDK
	    add('//platform.twitter.com/widgets.js', 'tweetjs');

	    fjs.parentNode.insertBefore(frag, fjs);
	}(document, 'script'));


  	// Google Analystics
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47051831-3', 'auto');
    ga('send', 'pageview');

    // add target='_blank' when href has different hostname
    (function() {
		var links = document.links;
		for (var i = 0; i < links.length; i++) {
			if (links[i].hostname != window.location.hostname) {
				links[i].target = '_blank';
			}
		}
	}());

  </script>

  <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
</html>
